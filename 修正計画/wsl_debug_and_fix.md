# WSL環境での/login 404エラー修正計画

## 問題の特定
ユーザーはVSCode + WSL環境で実行しており、私のネイティブLinux環境とは異なるネットワーク設定が原因で404エラーが発生している可能性があります。

## WSL特有の問題

### 1. ネットワーク設定の違い
- WSLのlocalhost解決の問題
- ポートバインディングの違い
- ネットワークインターフェースの設定

### 2. ホスト設定の問題
- `--host 0.0.0.0` vs `--host 127.0.0.1`
- WSLでのIPアドレス解決

### 3. ファイアウォール/セキュリティ設定
- Windows Defenderファイアウォール
- WSLネットワークアクセス制限

## 修正戦略

### Phase 1: ホスト設定の修正
1. `--host 127.0.0.1` での起動テスト
2. WSL IPアドレスでの起動テスト
3. ポート設定の確認

### Phase 2: FastAPI設定の調整
1. CORS設定の確認
2. 静的ファイル設定の追加
3. ルート登録順序の再確認

### Phase 3: WSL固有の設定
1. WSL2ネットワーク設定の確認
2. Windows側からのアクセステスト
3. ポートフォワーディング設定

## 実装手順

### 1. サーバー起動方法の変更
```bash
# 現在の起動方法
python -m uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload

# WSL用の起動方法
python -m uvicorn src.main:app --host 127.0.0.1 --port 8000 --reload
```

### 2. FastAPI設定の調整
- CORS設定の強化
- 静的ファイルマウントの追加
- ルート優先度の調整

### 3. デバッグ用エンドポイントの追加
- ネットワーク情報表示エンドポイント
- 環境情報表示エンドポイント
- ルート一覧表示エンドポイント

## 検証方法

### WSL環境での確認項目
1. `curl http://127.0.0.1:8000/login`
2. `curl http://localhost:8000/login`
3. WSL IPアドレスでのアクセス
4. Windows側ブラウザからのアクセス

### ログ確認項目
1. サーバー起動ログ
2. リクエスト処理ログ
3. ミドルウェア実行ログ
4. エラーログの詳細

## 期待される結果
- WSL環境で/loginが200 OKを返す
- 認証フロー全体が正常動作
- Windows側ブラウザからのアクセスが可能
